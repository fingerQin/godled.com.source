[TOC]

##客户端 APP 与前端页面交互规范文档

客户端（iOS/Android）与内嵌 H5 页面在一些特殊情况下会进行交互。所以，我们需要客户端 APP 支持此类方法供 H5 使用。



### 1 H5 需要获取 APP 的信息列举

具体包含如下方面：

- 获取用户登录时生成的 TOKEN 会话令牌。
- 获取用户所在位置经纬度。
- 获取用户设备编号。
- 获取信鸽分配的推送设备号。
- 获取当前 APP 版本号。
- 获取当前 APP 下载的渠道。
- 获取当前 APP 的平台标识。



### 2 APP 需要实现的方法

#### 2.1 获取 APP 相关的信息

> 方法名称：getAppInfo()

返回参数：

|     参数     |       名称        |  类型   | 必须 | 备注                                                         |
| :----------: | :---------------: | :-----: | :--: | ------------------------------------------------------------ |
|    token     |  TOKEN 会话令牌   | String  |  是  | 如果已登录则返回，未登录返回空字符串                         |
|    app_v     | 客户端 APP 版本号 | String  |  是  | 格式：1.0.0                                                  |
|   platform   |     平台标识      | Integer |  是  | 1 - iOS、2 - Android。                                       |
|   channel    |     渠道标识      | String  |  是  | 这个标识，每个平台已经确定。比如：华为渠道的标识为：huawei。 |
|  longitude   |       经度        |  float  |  是  | 经度值。一般都是保留小数点后 6 位。未开启定位传 -1。         |
|   latitude   |       纬度        |  float  |  是  | 纬度值。一般都是保留小数点后 6 位。未开启定位传 -1。         |
|  unique_no   |    手机唯一码     | String  |  是  | 很多手机会提供一个这样的唯一码。服务端通常根据这个来限制活动参与次数。取不到传空字符串。 |
| device_token |  信鸽推送设备号   | String  |  是  | 信鸽会给每台手机生成一个设备号。                             |



#### 2.2 清空 token 会话令牌

由于 H5 调用了 APP 客户端的 TOKEN 会话令牌。当 H5 调用服务端接口的时候提示 TOKEN 失效。那么，此时需要把客户端的 TOKEN 清空。当下次客户端启动或者操作其他原生界面的时候，直接提示未登录。

> 方法名称：clearAppToken()



#### 2.3 检测 APP 是否打开系统通知

> 方法名称：checkAppNotifyStatus()

| 参数   | 名称     | 类型    | 必须 | 备注             |
| ------ | -------- | ------- | ---- | ---------------- |
| status | 打开状态 | Integer | 是   | 1-打开、0-关闭。 |

